# Пример бработки, анализ и визуализации

Добрый день! В этой статье разберём пример обработки данных на питоне. В качестве примера возьмём данные Amazon-products.csv на 550 000 строк.
  Для начала, их нужно загрузить в блокнот или среду разработки.
Используем библиотеку _Pandas_
> import pandas as pd \
data = pd.DataFrame(pd.read_csv('Amazon-Products.csv')) #открываем данные и помещаем их в датафрейм

Как правило, данные загрязнены. Стоит это проверить. Для этого посмотрим на уникальные значения в столбце рейтингов.
>data['ratings'].unique()

![image](https://github.com/Analyst-Vadim/Python/assets/85847435/60458647-47a8-4d7d-8cf9-39563e9976af)

В результате увидим, что кроме обычных оценок у нас есть и слова, и какие валютные значения. То есть то, что нам не нужно.
Для начала продемонстрирую простую обработку через цикл.
![image](https://github.com/Analyst-Vadim/Python/assets/85847435/e8f0b20a-ad39-4ab5-9ebc-fa5abc0494d6)

Обработка занимает несколько секунд, что достаточно много для такого набора данных. А в реальных задачах и в сотни раз больше, поэтому нужно писать код оптимальнее. Для это используем лямбда функции.
![image](https://github.com/Analyst-Vadim/SQL-Examples/assets/85847435/4ae78816-8514-44d7-8b1e-4090ac4aa331)

Логика та же. Меняем пустые значения на 0 (строка), дальше ищем значения, которые не подходят под формат рейтинга (число, точка, число), и в нашем датафрейме меняем эти значения на 0 (строка). После этого меняем тип данных на float и готово, наши данные очищены.

В столбце _actual_price_ у нас есть знак валюты и десятичный разделитель запятая, что мешает нам привести данные к типу float.
Решить первую проблему несложно, нужно просто убрать первый знак во всём столбце

>data['actual_price'] = data['actual_price'].fillna('₹0')  #меняем пустые значения на ₹0\
data['actual_price'] = data['actual_price'].astype('str')  #приводим все значения к строковому типу\
data['actual_price'] = data['actual_price'].apply(lambda x: x[1:]) # убираем первый симов из всего столбца

Чтобы убрать запятые, мы могли бы просто поменять запятую в числе на точку. Но есть числа, где запятых 2. Значит нельзя применить простую замену.
Поэтому поделим наш столбец на 2. В первом (левом) удалим запятую, а во втором (правом) заменим запятую на точку. 
После этого соединим их, приведём к типу float и можем агрегировать данные!
![image](https://github.com/Analyst-Vadim/SQL-Examples/assets/85847435/9aaee694-0761-40bd-8367-6edc6bdec73e)
